import{a as m,d as L,r as i,o as R,c as $,e as z,g as x,f as a,w as t,n as f,p as A,q as S,E as g,y as j,h as r,z as F,_ as G}from"./index-rAObinJ9.js";const y={async getTags(){return(await m.get("/tags")).data.data},async getTag(n){return(await m.get(`/tags/${n}`)).data.data},async createTag(n){return(await m.post("/tags",n)).data.data},async updateTag(n,d){return(await m.put(`/tags/${n}`,d)).data.data},async deleteTag(n){await m.delete(`/tags/${n}`)}},H={class:"tags-container"},J={class:"header"},K={class:"dialog-footer"},O=L({__name:"TagList",setup(n){const d=i([]),v=i(!1),u=i(!1),p=i("add"),w=i(),b=i(!1),l=i({name:"",description:""}),B={name:[{required:!0,message:"请输入标签名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],description:[{max:500,message:"描述不能超过 500 个字符",trigger:"blur"}]},T=async()=>{v.value=!0;try{d.value=await y.getTags()}catch{g.error("获取数据失败")}finally{v.value=!1}};R(()=>{T()});const V=s=>{p.value=s?"edit":"add",s?l.value={...s}:l.value={name:"",description:""},u.value=!0},D=async()=>{if(w.value){await w.value.validate(),b.value=!0;try{p.value==="add"?await y.createTag(l.value):await y.updateTag(l.value.id,l.value),g.success(p.value==="add"?"添加成功":"更新成功"),u.value=!1,T()}catch{g.error(p.value==="add"?"添加失败":"更新失败")}finally{b.value=!1}}},E=async s=>{try{await j.confirm(`确定要删除标签"${s.name}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await y.deleteTag(s.id),g.success("删除成功"),T()}catch(e){e!=="cancel"&&g.error("删除失败")}};return(s,e)=>{const c=r("el-button"),_=r("el-table-column"),M=r("el-button-group"),N=r("el-table"),k=r("el-input"),C=r("el-form-item"),U=r("el-form"),h=r("el-dialog"),q=F("loading");return $(),z("div",H,[x("div",J,[e[6]||(e[6]=x("h2",null,"标签管理",-1)),a(c,{type:"primary",onClick:e[0]||(e[0]=o=>V())},{default:t(()=>e[5]||(e[5]=[f("添加标签")])),_:1})]),A(($(),S(N,{data:d.value,style:{width:"100%"}},{default:t(()=>[a(_,{prop:"id",label:"ID",width:"80"}),a(_,{prop:"name",label:"名称"}),a(_,{prop:"description",label:"描述","show-overflow-tooltip":""}),a(_,{label:"操作",width:"200"},{default:t(({row:o})=>[a(M,null,{default:t(()=>[a(c,{type:"primary",onClick:I=>V(o)},{default:t(()=>e[7]||(e[7]=[f("编辑")])),_:2},1032,["onClick"]),a(c,{type:"danger",onClick:I=>E(o)},{default:t(()=>e[8]||(e[8]=[f("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[q,v.value]]),a(h,{title:p.value==="add"?"添加标签":"编辑标签",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value=o),width:"500px"},{footer:t(()=>[x("span",K,[a(c,{onClick:e[3]||(e[3]=o=>u.value=!1)},{default:t(()=>e[9]||(e[9]=[f("取消")])),_:1}),a(c,{type:"primary",onClick:D,loading:b.value},{default:t(()=>e[10]||(e[10]=[f("确定")])),_:1},8,["loading"])])]),default:t(()=>[a(U,{ref_key:"formRef",ref:w,model:l.value,rules:B,"label-width":"80px"},{default:t(()=>[a(C,{label:"名称",prop:"name"},{default:t(()=>[a(k,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.name=o),placeholder:"请输入标签名称"},null,8,["modelValue"])]),_:1}),a(C,{label:"描述",prop:"description"},{default:t(()=>[a(k,{modelValue:l.value.description,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.description=o),type:"textarea",placeholder:"请输入标签描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),Q=G(O,[["__scopeId","data-v-a7916c10"]]);export{Q as default};
